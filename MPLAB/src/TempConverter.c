
#include <xc.h>         /* XC8 General Include File */
#include <stdlib.h>

struct TempData {
    unsigned char temp;
    unsigned short  millivolt;
};

static const struct TempData  dati[] ={
    {255,3597},
    {254,3593},
    {253,3588},
    {252,3585},
    {251,3579},
    {250,3576},
    {249,3571},
    {248,3567},
    {247,3562},
    {246,3559},
    {245,3554},
    {244,3550},
    {243,3545},
    {242,3542},
    {241,3537},
    {240,3533},
    {239,3528},
    {238,3525},
    {237,3519},
    {236,3516},
    {235,3511},
    {234,3507},
    {233,3502},
    {232,3499},
    {231,3494},
    {230,3490},
    {229,3485},
    {228,3482},
    {227,3477},
    {226,3473},
    {225,3468},
    {224,3465},
    {223,3459},
    {222,3456},
    {221,3451},
    {220,3447},
    {219,3442},
    {218,3439},
    {217,3434},
    {216,3430},
    {215,3425},
    {214,3422},
    {213,3417},
    {212,3413},
    {211,3408},
    {210,3405},
    {209,3401},
    {208,3396},
    {207,3393},
    {206,3387},
    {205,3384},
    {204,3379},
    {203,3376},
    {202,3370},
    {201,3367},
    {200,3362},
    {199,3358},
    {198,3353},
    {197,3350},
    {196,3345},
    {195,3341},
    {194,3336},
    {193,3333},
    {192,3327},
    {191,3324},
    {190,3321},
    {189,3316},
    {188,3312},
    {187,3307},
    {186,3303},
    {185,3298},
    {184,3295},
    {183,3290},
    {182,3286},
    {181,3281},
    {180,3278},
    {179,3373},
    {178,3369},
    {177,3364},
    {176,3261},
    {175,3257},
    {174,3252},
    {173,3249},
    {172,3243},
    {171,3240},
    {170,3235},
    {169,3231},
    {168,3226},
    {167,3223},
    {166,3218},
    {165,3214},
    {164,3209},
    {163,3206},
    {162,3201},
    {161,3197},
    {160,3192},
    {159,3189},
    {158,3183},
    {157,3180},
    {156,3175},
    {155,3171},
    {154,3168},
    {153,3163},
    {152,3160},
    {151,3154},
    {150,3151},
    {149,3146},
    {148,3142},
    {147,3137},
    {146,3134},
    {145,3129},
    {144,3125},
    {143,3120},
    {142,3117},
    {141,3111},
    {140,3108},
    {139,3103},
    {138,3100},
    {137,3094},
    {136,3091},
    {135,3086},
    {134,3082},
    {133,3077},
    {132,3074},
    {131,3069},
    {130,3063},
    {129,3060},
    {128,3055},
    {127,3051},
    {126,3046},
    {125,3043},
    {124,3038},
    {123,3034},
    {122,3029},
    {121,3026},
    {120,3021},
    {119,3017},
    {118,3012},
    {117,3009},
    {116,3003},
    {115,3000},
    {114,2995},
    {113,2990},
    {112,2986},
    {111,2981},
    {110,2978},
    {109,2973},
    {108,2969},
    {107,2964},
    {106,2961},
    {105,2956},
    {104,2952},
    {103,2947},
    {102,2942},
    {101,2938},
    {100,2933},
    {99,2930},
    {98,2925},
    {97,2921},
    {96,2916},
    {95,2911},
    {94,2907},
    {93,2902},
    {92,2899},
    {91,2894},
    {90,2890},
    {89,2885},
    {88,2882},
    {87,2877},
    {86,2871},
    {85,2868},
    {84,2863},
    {83,2860},
    {82,2854},
    {81,2851},
    {80,2846},
    {79,2941},
    {78,2937},
    {77,2832},
    {76,2829},
    {75,2824},
    {74,2820},
    {73,2815},
    {72,2810},
    {71,2806},
    {70,2801},
    {69,2798},
    {68,2793},
    {67,2789},
    {66,2784},
    {65,2779},
    {64,2776},
    {63,2770},
    {62,2767},
    {61,2762},
    {60,2758},
    {59,2753},
    {58,2750},
    {57,2745},
    {56,2740},
    {55,2736},
    {54,2731},
    {53,2727},
    {52,2722},
    {51,2719},
    {50,2714},
    {49,2710},
    {48,2705},
    {47,2700},
    {46,2697},
    {45,2692},
    {44,2688},
    {43,2683},
    {42,2680},
    {41,2674},
    {40,2671},
    {39,2666},
    {38,2662},
    {37,2657},
    {36,2654},
    {35,2649},
    {34,2644},
    {33,2640},
    {32,2635},
    {31,2632},
    {30,2626},
    {29,2623},
    {28,2618},
    {27,2614},
    {26,2609},
    {25,2606},
    {24,2601},
    {23,2597},
    {22,2592},
    {21,2589},
    {20,2584},
    {19,2580},
    {18,2575},
    {17,2572},
    {16,2566},
    {15,2563},
    {14,2558},
    {13,2554},
    {12,2549},
    {11,2546},
    {10,2542},
    {9,2537},
    {8,2534},
    {7,2529},
    {6,2525},
    {5,2520},
    {4,2517},
    {3,2512},
    {2,2508},
    {1,2503},
    {0,2500}
};


unsigned short tempConvert(unsigned short mv){
    if (mv == 0){
        return 2500;
    }
    const struct TempData * iter = dati;
    for (unsigned int i=0; i < sizeof(dati); i++){
        if (iter->millivolt <= mv){
            return iter->temp;
        }
        iter++;
    }
    return 0;
}